$(function(){});$(function(){$(".audiobook-switcher a").tooltip({tip:".tooltip",effect:"fade",fadeOutSpeed:100,predelay:0,position:"bottom right",offset:[-25,5]});$("#search #indexTankForm").submit(function(){var b=$(this).find("#term").val();_gaq&&_gaq.push(["_trackEvent","search_events","search",b])});$("#fb_connect_notification a#fb_decline").click(function(){$("#fb_connect_notification ").slideUp("slow");return!1});$(".pagination ul li.active, .pagination ul li.gap").live("click",function(){return!1})});
function isLoggedIn(){var b=!1;FB.getLoginStatus(function(a){a.status=="connected"&&(b=!0)});return b}function sendKissMetricsEvent(b,a){_kmq&&(a?_kmq.push(["record",b,a]):_kmq.push(["record",b]))}function unique(b){var a=[],c=0;a:for(;c<b.length;c++){for(var d=0;d<a.length;d++)if(a[d]==b[c])continue a;a[a.length]=b[c]}return a}function compressText(b,a){b.length>a&&(b=b.substring(0,a-3),b+="...");return b}
function ssLess(b,a){var c=[];$("<div>"+b+"</div>").find("b").each(function(){c.push($(this).text())});var d=b.replace(/<.*?>/g,"");d=compressText(d,a);for(index in c)d=d.replace(c[index],"<b>"+c[index]+"</b>");return d}var elementId="#term",apiUrl="http://6wfx.api.indextank.com",indexName="ClassiclyAutocomplete",source=apiUrl+"/v1/indexes/"+indexName+"/search",searchResults;
$.ui.autocomplete.prototype._renderItem=function(b,a){var c;c=a.type=="book"||a.type=="audiobook"?"<div class='with-cover'><img src='"+a.cover_url+"'class='micro-cover'><span class='text'>"+ssLess(a.label,40)+"<span class='type'>"+a.type+"</span></span></div>":a.type=="collection"?a.label+"<span class='type'>"+a.type+"</span>":a.label;return $("<li></li>").data("item.autocomplete",a).append($("<a></a>").html(c)).appendTo(b)};
google.setOnLoadCallback(function(){$(function(){$(elementId).autocomplete({source:function(b,a){searchResults=[];$.ajax({url:apiUrl+"/v1/indexes/"+indexName+"/autocomplete",dataType:"jsonp",data:{query:b.term,field:"text"},success:function(c){$.ajax({url:source,dataType:"jsonp",data:{len:10,q:"("+c.suggestions[0]+") OR full:"+c.suggestions[0].replace(" ","")+"^100000",snippet:"text",fetch:"text,type,slug,cover_url"},success:function(c){$.map(c.results,function(b){searchResults.push({label:b.snippet_text,
value:b.text,type:b.type,slug:b.slug,cover_url:b.cover_url})});searchResults.push({label:"search <b>"+b.term+"</b>",value:b.term});a($.each(searchResults,function(b,a){return{label:a.label,value:a.value}}))}})}})},delay:250,select:function(b,a){b.target.value=a.item.value;a.item.slug!=void 0?window.location="http://www.classicly.com"+a.item.slug:$(b.target.form).submit()}})})});
(function(b){function a(e){var a=b('meta[name="csrf-token"]').attr("content");a&&e.setRequestHeader("X-CSRF-Token",a)}function c(e,a,c){a=new b.Event(a);e.trigger(a,c);return a.result!==!1}function d(e){var a,d,g,h=e.attr("data-type")||b.ajaxSettings&&b.ajaxSettings.dataType;if(e.is("form")){a=e.attr("method");d=e.attr("action");g=e.serializeArray();var f=e.data("ujs:submit-button");f&&(g.push(f),e.data("ujs:submit-button",null))}else a=e.attr("data-method"),d=e.attr("href"),g=null;b.ajax({url:d,
type:a||"GET",data:g,dataType:h,beforeSend:function(b,a){a.dataType===void 0&&b.setRequestHeader("accept","*/*;q=0.5, "+a.accepts.script);return c(e,"ajax:beforeSend",[b,a])},success:function(b,a,i){e.trigger("ajax:success",[b,a,i])},complete:function(b,a){e.trigger("ajax:complete",[b,a])},error:function(b,a,i){e.trigger("ajax:error",[b,a,i])}})}function f(a){a.find("input[data-disable-with]").each(function(){var a=b(this);a.data("ujs:enable-with",a.val()).val(a.attr("data-disable-with")).attr("disabled",
"disabled")})}function j(a){a.find("input[data-disable-with]").each(function(){var a=b(this);a.val(a.data("ujs:enable-with")).removeAttr("disabled")})}function h(a){var b=a.attr("data-confirm");return!b||c(a,"confirm")&&confirm(b)}function k(a){var c=!1;a.find("input[name][required]").each(function(){b(this).val()||(c=!0)});return c}"ajaxPrefilter"in b?b.ajaxPrefilter(function(b,c,d){a(d)}):b(document).ajaxSend(function(b,c){a(c)});b("a[data-confirm], a[data-method], a[data-remote]").live("click.rails",
function(){var a=b(this);if(!h(a))return!1;if(a.attr("data-remote")!=void 0)return d(a),!1;else if(a.attr("data-method")){var c=a.attr("href"),f=a.attr("data-method");a=b("meta[name=csrf-token]").attr("content");var g=b("meta[name=csrf-param]").attr("content");c=b('<form method="post" action="'+c+'"></form>');f='<input name="_method" value="'+f+'" type="hidden" />';g!==void 0&&a!==void 0&&(f+='<input name="'+g+'" value="'+a+'" type="hidden" />');c.hide().append(f).appendTo("body");c.submit();return!1}});
b("form").live("submit.rails",function(){var a=b(this),c=a.attr("data-remote")!=void 0;if(!h(a))return!1;if(k(a))return!c;if(c)return d(a),!1;else setTimeout(function(){f(a)},13)});b("form input[type=submit], form button[type=submit], form button:not([type])").live("click.rails",function(){var a=b(this);if(!h(a))return!1;var c=a.attr("name");c=c?{name:c,value:a.val()}:null;a.closest("form").data("ujs:submit-button",c)});b("form").live("ajax:beforeSend.rails",function(a){this==a.target&&f(b(this))});
b("form").live("ajax:complete.rails",function(a){this==a.target&&j(b(this))})})(jQuery);function hideGlobalNotifications(b){$(".global-notification").each(function(){var a=0;b&&(a=500);$(this).is(":visible")&&($(this).animate({top:"-="+$(this).outerHeight()},{duration:a,easing:"swing",complete:function(){$(this).hide()}}),$("#site-container").animate({top:"-="+$(this).outerHeight()},{duration:a,easing:"swing"}))})}
function showGlobalNotifications(){$(".global-notification").each(function(){animation_length=500;$(this).is(":visible")||($(this).show(),$(this).animate({top:"+="+$(this).outerHeight()},{duration:animation_length,easing:"swing"}),$("#site-container").animate({top:"+="+$(this).outerHeight()},{duration:animation_length,easing:"swing"}))})};
